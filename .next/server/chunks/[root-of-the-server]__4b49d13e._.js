module.exports=[54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},71815,(e,t,r)=>{t.exports=e.x("sharp",()=>require("sharp"))},60198,e=>{"use strict";let t;var r,n,o,a,s,i,l=e.i(47909),u=e.i(74017),p=e.i(96250),c=e.i(59756),d=e.i(61916),f=e.i(14444),g=e.i(37092),h=e.i(69741),m=e.i(16795),y=e.i(87718),w=e.i(95169),R=e.i(47587),E=e.i(66012),b=e.i(70101),v=e.i(26937),C=e.i(10372),O=e.i(93695);e.i(52474);var T=e.i(220),_=e.i(89171),S=e.i(54799),N=e.i(874),P=e.i(71815),x=e.i(81769);let A=process.env.MONGODB_URI;if(!A)throw Error("Missing MONGODB_URI. Add it to your environment configuration (e.g. .env.local).");let I=globalThis;async function B(){return t}async function M(){let e=await B(),t=process.env.MONGODB_DB||"sspl",r=process.env.MONGODB_COLLECTION||"submissions";return e.db(t).collection(r)}async function j(e){let t=await M();await t.insertOne(e)}I._mongoClientPromise||(I._mongoClientPromise=new x.MongoClient(A,{}).connect()),t=I._mongoClientPromise;var D=e.i(59485);e.i(14747),(r=a||(a={})).PROFILE="profile",r.SSO_SESSION="sso-session",r.SERVICES="services",e.i(46786);let{readFile:U}=e.i(22734).promises,k={},q={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),k[e]=t,q[t]=e}(n=s||(s={}))[n.boolTrue=0]="boolTrue",n[n.boolFalse=1]="boolFalse",n[n.byte=2]="byte",n[n.short=3]="short",n[n.integer=4]="integer",n[n.long=5]="long",n[n.byteArray=6]="byteArray",n[n.string=7]="string",n[n.timestamp=8]="timestamp",n[n.uuid=9]="uuid";(o=i||(i={})).ENV="env",o.CONFIG="shared config entry";let $=process.env.B2_S3_ENDPOINT,K=process.env.B2_S3_REGION||"us-east-005",H=process.env.B2_KEY_ID,L=process.env.B2_APPLICATION_KEY,F=process.env.B2_BUCKET;if(process.env.B2_SIGNED_URL_TTL,!$)throw Error("Missing B2_S3_ENDPOINT in environment configuration.");if(!H||!L)throw Error("Missing Backblaze B2 credentials (B2_KEY_ID/B2_APPLICATION_KEY).");if(!F)throw Error("Missing Backblaze B2 bucket (B2_BUCKET).");let z=new D.S3Client({endpoint:$,region:K,credentials:{accessKeyId:H,secretAccessKey:L},forcePathStyle:!0});async function G({key:e,body:t,contentType:r,metadata:n}){if(!e)throw Error("uploadObject requires a key.");if(!t)throw Error("uploadObject requires a body.");let o=new D.PutObjectCommand({Bucket:F,Key:e,Body:t,ContentType:r,Metadata:n});return await z.send(o),e}let Y=process.env.OCR_SPACE_ENDPOINT??"https://api.ocr.space/parse/image",V="image/jpeg";function W(e){return e?.replace(/[^a-z0-9.\-_]/gi,"_").toLowerCase()||"upload"}function X(e,t){let r=W(e).replace(/\.[^.]+$/,"")||t;return`${r}.jpg`}function Z(e,t){let r=W(t),n=`${Date.now()}-${S.default.randomUUID()}`;return`${e}/${n}-${r}`}function J(e){let t=e?.type?.toLowerCase();if(t?.startsWith("image/"))return!0;let r=e?.name?.toLowerCase()??"";return/\.(jpg|jpeg|png|webp|heic|heif|gif)$/.test(r)}async function Q(e){let t=80,r=1600,n=await (0,P.default)(e).rotate().resize({width:r,withoutEnlargement:!0}).jpeg({quality:t}).toBuffer();for(;n.length>1048576&&t>40;)t-=10,n=await (0,P.default)(e).rotate().resize({width:r,withoutEnlargement:!0}).jpeg({quality:t}).toBuffer();for(;n.length>1048576&&r>640;)r=Math.max(640,Math.round(.8*r)),n=await (0,P.default)(e).rotate().resize({width:r,withoutEnlargement:!0}).jpeg({quality:t}).toBuffer();if(n.length>1048576)throw Error("Unable to compress image under 1 MB.");return{buffer:n,contentType:V}}async function ee(e,t,r){let n=process.env.OCR_SPACE_API_KEY;if(!n)throw Error("OCR_SPACE_API_KEY is not configured.");let o=new FormData;o.append("apikey",n),o.append("language","eng"),o.append("isOverlayRequired","false"),o.append("scale","true"),o.append("OCREngine","5");let a=X(t,"payment"),s=new N.Blob([e],{type:r||V});o.append("file",s,a);let i=await fetch(Y,{method:"POST",body:o});if(!i.ok)throw Error(`OCR request failed with status ${i.status} ${i.statusText}`);let l=await i.json();if(l.IsErroredOnProcessing)throw Error(Array.isArray(l.ErrorMessage)?l.ErrorMessage.join("; "):l.ErrorMessage||"OCR processing failed.");return l.ParsedResults?.map(e=>e.ParsedText).join("\n")??""}async function et(e){let t=await e.formData(),r=t.get("name")?.toString().trim(),n=t.get("address")?.toString().trim(),o=t.get("playerType")?.toString(),a=t.get("playerTypeOther")?.toString().trim(),s=t.get("tshirtSize")?.toString(),i=t.get("jerseyName")?.toString().trim(),l=t.get("jerseyNumber")?.toString().trim(),u=t.get("foodType")?.toString(),p=t.get("foodTypeOther")?.toString().trim(),c=t.get("feeResponse")?.toString(),d=t.get("feeResponseOther")?.toString().trim(),f=t.get("photo"),g=t.get("paymentScreenshot");if(!r||!n||!o||!s||!i||!l||!u||!c||!(f instanceof File)||!(g instanceof File))return _.NextResponse.json({error:"Please complete all required fields with valid uploads."},{status:400});if(!J(f)||!J(g))return _.NextResponse.json({error:"Only image files are accepted for photo and payment proof."},{status:400});if(f.size>1048576||g.size>1048576)return _.NextResponse.json({error:"Images must be 1 MB or smaller."},{status:413});if("other"===o&&!a)return _.NextResponse.json({error:"Please specify your player type."},{status:400});if("other"===u&&!p)return _.NextResponse.json({error:"Please specify your food preference."},{status:400});if("other"===c&&!d)return _.NextResponse.json({error:"Please describe your fee status."},{status:400});try{let e=Buffer.from(await f.arrayBuffer()),t=Buffer.from(await g.arrayBuffer()),h=await Q(e),m=await Q(t),y=await ee(m.buffer,g.name,m.contentType);if(!function(e){if(!e)return!1;let t=e.toLowerCase().replace(/o/g,"0");if(t.replace(/[^0-9]/g,"").includes("900")||t.includes("₹900")||t.includes("rs 900"))return!0;let r=t.replace(/[,₹]/g,"");return[/\b900(?:\.00)?\b/,/\b900\/-\b/,/\brs\.?\s*900(?:\.00)?\b/,/\binr\.?\s*900(?:\.00)?\b/,/\bamount\s*:?\.?\s*900(?:\.00)?\b/,/\bamount\s*:?\.?\s*rs\.?\s*900(?:\.00)?\b/].some(e=>e.test(r))}(y))return _.NextResponse.json({error:"Unable to confirm the ₹900 payment from the screenshot. Please ensure the amount is clearly visible."},{status:422});let w=await G({key:Z("photos",X(f.name,"photo")),body:h.buffer,contentType:h.contentType,metadata:{originalname:W(f.name||"photo"),originaltype:f.type||""}}),R=await G({key:Z("payments",X(g.name,"payment")),body:m.buffer,contentType:m.contentType,metadata:{originalname:W(g.name||"payment"),originaltype:g.type||""}}),E={id:S.default.randomUUID(),createdAt:new Date().toISOString(),name:r,address:n,playerType:o,playerTypeOther:"other"===o?a:"",tshirtSize:s,jerseyName:i,jerseyNumber:l,foodType:u,foodTypeOther:"other"===u?p:"",feeResponse:c,feeResponseOther:"other"===c?d:"",photoKey:w,photoContentType:h.contentType,paymentScreenshotKey:R,paymentContentType:m.contentType,ocrText:y};return await j(E),_.NextResponse.json({success:!0,submissionId:E.id},{status:201})}catch(r){console.error("Registration error",r);let e=r instanceof Error?r.message:"Unexpected upload error.",t="Unable to compress image under 1 MB."===e?413:500;return _.NextResponse.json({error:413===t?e:"Something went wrong while processing the registration."},{status:t})}}e.s(["POST",()=>et],50174);var er=e.i(50174);let en=new l.AppRouteRouteModule({definition:{kind:u.RouteKind.APP_ROUTE,page:"/api/register/route",pathname:"/api/register",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/register/route.js",nextConfigOutput:"",userland:er}),{workAsyncStorage:eo,workUnitAsyncStorage:ea,serverHooks:es}=en;function ei(){return(0,p.patchFetch)({workAsyncStorage:eo,workUnitAsyncStorage:ea})}async function el(e,t,r){en.isDev&&(0,c.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let n="/api/register/route";n=n.replace(/\/index$/,"")||"/";let o=await en.prepare(e,t,{srcPage:n,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:a,params:s,nextConfig:i,parsedUrl:l,isDraftMode:p,prerenderManifest:_,routerServerContext:S,isOnDemandRevalidate:N,revalidateOnlyGenerated:P,resolvedPathname:x,clientReferenceManifest:A,serverActionsManifest:I}=o,B=(0,h.normalizeAppPath)(n),M=!!(_.dynamicRoutes[B]||_.routes[x]),j=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,l,!1):t.end("This page could not be found"),null);if(M&&!p){let e=!!_.routes[x],t=_.dynamicRoutes[B];if(t&&!1===t.fallback&&!e){if(i.experimental.adapterPath)return await j();throw new O.NoFallbackError}}let D=null;!M||en.isDev||p||(D="/index"===(D=x)?"/":D);let U=!0===en.isDev||!M,k=M&&!U;I&&A&&(0,f.setReferenceManifestsSingleton)({page:n,clientReferenceManifest:A,serverActionsManifest:I,serverModuleMap:(0,g.createServerModuleMap)({serverActionsManifest:I})});let q=e.method||"GET",$=(0,d.getTracer)(),K=$.getActiveScopeSpan(),H={params:s,prerenderManifest:_,renderOpts:{experimental:{authInterrupts:!!i.experimental.authInterrupts},cacheComponents:!!i.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,c.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:i.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>en.onRequestError(e,t,n,S)},sharedContext:{buildId:a}},L=new m.NodeNextRequest(e),F=new m.NodeNextResponse(t),z=y.NextRequestAdapter.fromNodeNextRequest(L,(0,y.signalFromNodeResponse)(t));try{let o=async e=>en.handle(z,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==w.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=r.get("next.route");if(o){let t=`${q} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${n}`)}),a=!!(0,c.getRequestMeta)(e,"minimalMode"),s=async s=>{var l,c;let d=async({previousCacheEntry:i})=>{try{if(!a&&N&&P&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await o(s);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=H.renderOpts.collectedTags;if(!M)return await (0,E.sendResponse)(L,F,n,H.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,b.toNodeOutgoingHttpHeaders)(n.headers);u&&(t[C.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=C.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,o=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=C.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:T.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:o}}}}catch(t){throw(null==i?void 0:i.isStale)&&await en.onRequestError(e,t,{routerKind:"App Router",routePath:n,routeType:"route",revalidateReason:(0,R.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:N})},S),t}},f=await en.handleResponse({req:e,nextConfig:i,cacheKey:D,routeKind:u.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:_,isRoutePPREnabled:!1,isOnDemandRevalidate:N,revalidateOnlyGenerated:P,responseGenerator:d,waitUntil:r.waitUntil,isMinimalMode:a});if(!M)return null;if((null==f||null==(l=f.value)?void 0:l.kind)!==T.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==f||null==(c=f.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});a||t.setHeader("x-nextjs-cache",N?"REVALIDATED":f.isMiss?"MISS":f.isStale?"STALE":"HIT"),p&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let g=(0,b.fromNodeOutgoingHttpHeaders)(f.value.headers);return a&&M||g.delete(C.NEXT_CACHE_TAGS_HEADER),!f.cacheControl||t.getHeader("Cache-Control")||g.get("Cache-Control")||g.set("Cache-Control",(0,v.getCacheControlHeader)(f.cacheControl)),await (0,E.sendResponse)(L,F,new Response(f.value.body,{headers:g,status:f.value.status||200})),null};K?await s(K):await $.withPropagatedContext(e.headers,()=>$.trace(w.BaseServerSpan.handleRequest,{spanName:`${q} ${n}`,kind:d.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},s))}catch(t){if(t instanceof O.NoFallbackError||await en.onRequestError(e,t,{routerKind:"App Router",routePath:B,routeType:"route",revalidateReason:(0,R.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:N})}),M)throw t;return await (0,E.sendResponse)(L,F,new Response(null,{status:500})),null}}e.s(["handler",()=>el,"patchFetch",()=>ei,"routeModule",()=>en,"serverHooks",()=>es,"workAsyncStorage",()=>eo,"workUnitAsyncStorage",()=>ea],60198)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4b49d13e._.js.map